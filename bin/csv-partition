#!/usr/bin/env python3
from sys import argv, stdin
from pathlib import Path
from pandas import read_csv


def main():
    columns = argv[1:]
    dataframe = read_csv(stdin, sep=None, engine="python")
    groups = dataframe.groupby(columns)
    for name, dataframe in groups:
        filepath = Path(*(map(str, name))).with_suffix(".csv")
        filepath.parent.mkdir(parents=True, exist_ok=True)
        dataframe.to_csv(filepath, index=False)


if __name__ == "__main__":
    main()

#!/usr/bin/env python3
from sys import argv, stdin
from pathlib import Path


def main():
    outdir = Path(argv[1])
    for inpath in stdin:
        inpath = Path(inpath.strip())
        with open(inpath, "r", encoding="utf-8") as file:
            lines = file.readlines()
        length = len(lines)
        if length > 0:
            padding = len(str(length))
            batch_size = max(length // 2, 1)
            for i in range(0, length, batch_size):
                batch = lines[i : i + batch_size]  # noqa: E203
                stem = f"{inpath.stem}-{i + 1:0{padding}d}"
                outpath = outdir / inpath.with_stem(stem)
                outpath.parent.mkdir(parents=True, exist_ok=True)
                with open(outpath, "w", encoding="utf-8") as file:
                    for line in batch:
                        file.write(line)
                print(outpath)


if __name__ == "__main__":
    main()

#!/usr/bin/env python3
from os import environ
from sys import argv, stdin
from transformers import AutoTokenizer


def main():
    max_length = int(argv[1]) if len(argv) > 1 else None
    model_name = environ.get("MODEL", "sentence-transformers/LaBSE")
    tokenizer = AutoTokenizer.from_pretrained(model_name)
    kwargs = (
        {}
        if max_length is None
        else {
            "max_length": max_length,
            "padding": "max_length",
            "truncation": True,
        }
    )
    for line in stdin:
        result = tokenizer(line.strip(), **kwargs)
        ids = result["input_ids"]
        print(" ".join(map(str, ids)))


if __name__ == "__main__":
    main()
